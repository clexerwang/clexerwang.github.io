<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="目前流行的js模块化规范有CommonJS、AMD、CMD以及ES6的模块系统 CommonJS—NodeJS根据CommonJS规范，一个单独的文件就是一个模块。每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非定义为global对象的属性。 ```Node.js```有四个重要的环境变量为模块化的实现提供支持：```module```、```export">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript的模块化">
<meta property="og:url" content="http://yoursite.com/2019/03/13/JavaScript的模块化/index.html">
<meta property="og:site_name" content="Clexer">
<meta property="og:description" content="目前流行的js模块化规范有CommonJS、AMD、CMD以及ES6的模块系统 CommonJS—NodeJS根据CommonJS规范，一个单独的文件就是一个模块。每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非定义为global对象的属性。 ```Node.js```有四个重要的环境变量为模块化的实现提供支持：```module```、```export">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-03-13T11:57:56.464Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript的模块化">
<meta name="twitter:description" content="目前流行的js模块化规范有CommonJS、AMD、CMD以及ES6的模块系统 CommonJS—NodeJS根据CommonJS规范，一个单独的文件就是一个模块。每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非定义为global对象的属性。 ```Node.js```有四个重要的环境变量为模块化的实现提供支持：```module```、```export">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>JavaScript的模块化</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="http://github.com/clexerwang">Github</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/03/13/ES6-Generator/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/03/13/Promise的实现/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/03/13/JavaScript的模块化/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&text=JavaScript的模块化"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&is_video=false&description=JavaScript的模块化"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=JavaScript的模块化&body=Check out this article: http://yoursite.com/2019/03/13/JavaScript的模块化/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&name=JavaScript的模块化&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CommonJS—NodeJS"><span class="toc-number">1.</span> <span class="toc-text">CommonJS—NodeJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CMD—SeaJS"><span class="toc-number">2.</span> <span class="toc-text">CMD—SeaJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AMD与CMD"><span class="toc-number">3.</span> <span class="toc-text">AMD与CMD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6模块机制："><span class="toc-number">4.</span> <span class="toc-text">ES6模块机制：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6与CommonJS区别"><span class="toc-number">5.</span> <span class="toc-text">ES6与CommonJS区别</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        JavaScript的模块化
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Clexer</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-03-13T08:45:32.000Z" itemprop="datePublished">2019-03-13</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>目前流行的js模块化规范有CommonJS、AMD、CMD以及ES6的模块系统</p>
<h2 id="CommonJS—NodeJS"><a href="#CommonJS—NodeJS" class="headerlink" title="CommonJS—NodeJS"></a>CommonJS—NodeJS</h2><p>根据<code>CommonJS</code>规范，一个单独的文件就是一个模块。每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非定义为<code>global</code>对象的属性。</p>
<pre><code class="Node.js```是```CommonJS```规范的主要实践者，```CommonJS```用```同步```的方式加载模块。">```Node.js```有四个重要的环境变量为模块化的实现提供支持：```module```、```exports```、```require```、```global```。
```module.exports```是当前模块对外输出的接口（不推荐直接用exports），把需要对外输出的内容放在该对象中。
```require```用来加载模块

commonJS用同步的方式加载模块。在服务端，模块文件都存在本地磁盘，读取非常快，所以这样做不会有问题。但是在浏览器端，限于网络原因，更合理的方案是使用异步加载。


### exports和module.exports的关系
它们之间的关系其实类似于这样：

    var exports = module.exports
    //所以，exports的本质还是module.exports,但是不能把要输出的值赋值给exports；

    exports = {}；这样相当于修改了exports的指向。

## AMD---RequireJS

```RequireJS```在加载依赖模块时是异步加载，这样浏览器不会失去响应，同时它指定的回调函数，只有在前面的模块都加载成功后，才会运行，解决了依赖性的问题。

```require.config()```用来指定引用路径，```define()```用来定义模块，```require()```用来加载模块。
使用时要先在网页中引入```require.js```,设置```data-main```属性：
```&lt;script src=&quot;js/require.js&quot; data-main=&quot;js/main&quot;&gt;&lt;/script&gt;
</code></pre>
<p>同时要设置一个入口文件<code>main.js</code>，<code>main.js</code>中配置<code>require.config()</code>并规定项目中用到的基础模块。</p>
<p>main.js:</p>
<pre><code>require.config(
    baseUrl: &quot;js/lib&quot;,
  paths: {
    &quot;jquery&quot;: &quot;jquery.min&quot;,  //实际路径为js/lib/jquery.min.js
    &quot;underscore&quot;: &quot;underscore.min&quot;,
  }
)
</code></pre><p>在引用模块时：<br>将模块名放在<code>[]</code>中作为<code>reqiure()</code>的第一参数；</p>
<pre><code>require([&#39;a&#39;],function(first_Module){

})
</code></pre><p>定义模块时：<br>如果我们定义的模块本身也依赖其他模块,那就需要将它们放在<code>[]</code>中作为<code>define()</code>的第一参数。</p>
<pre><code>define([&#39;a&#39;,&#39;b&#39;],function(module_a,module_b){

    return {}
})
</code></pre><h2 id="CMD—SeaJS"><a href="#CMD—SeaJS" class="headerlink" title="CMD—SeaJS"></a>CMD—SeaJS</h2><p><code>require.js</code>在申明依赖的模块时会在第一时间加载并执行模块内的代码。</p>
<p>CMD是另一种js模块化方案，它与AMD很类似，不同点在于：AMD 推崇<code>依赖前置、提前执行</code>，CMD推崇<code>依赖就近、延迟执行</code>。</p>
<p>定义模块：</p>
<pre><code>//require 是一个方法，接受模块标识作为唯一参数，用来获取其他模块提供的接口：require(id)；
//exports 是一个对象，用来向外提供模块接口；
//module 是一个对象，上面存储了与当前模块相关联的一些属性和方法；
define(function(require, exports, module) {
    var a = require(&#39;./a&#39;); //在需要时申明依赖模块
    a.doSomething();
    if (false) {
        var b = require(&#39;./b&#39;);
        b.doSomething();
    }
    exports.ab = function(){}; 
});
</code></pre><p>引用模块：</p>
<pre><code>seajs.use([&#39;a&#39;],function(module_a){

})
</code></pre><h2 id="AMD与CMD"><a href="#AMD与CMD" class="headerlink" title="AMD与CMD"></a>AMD与CMD</h2><p>AMD和CMD最大的区别是对依赖模块的执行时机处理不同：<br>AMD与CMD在加载模块时都是异步的，只不过AMD依赖前置，JS可以方便知道依赖模块是谁，立即加载，而CMD就近依赖，需要先把模块变为字符串解析一遍才知道依赖了那些模块，然后再加载模块。</p>
<p>AMD在加载模块完成后就会执行该模块，所有模块都加载执行完后会进入require的回调函数，执行主逻辑，这样的效果就是依赖模块的执行顺序和书写顺序不一定一致，看网络速度，哪个先下载下来，哪个先执行，但是主逻辑一定在所有依赖加载完成后才执行。<br>CMD加载完某个依赖模块后并不执行，只是下载而已，在所有依赖模块加载完成后进入主逻辑，遇到require语句的时候才执行对应的模块，这样模块的执行顺序和书写顺序是完全一致的。</p>
<h2 id="ES6模块机制："><a href="#ES6模块机制：" class="headerlink" title="ES6模块机制："></a>ES6模块机制：</h2><h2 id="ES6与CommonJS区别"><a href="#ES6与CommonJS区别" class="headerlink" title="ES6与CommonJS区别"></a>ES6与CommonJS区别</h2><p> CommonJS 模块是运行时加载，ES6 模块是编译时加载：</p>
<p><code>运行时加载</code>: CommonJS 模块就是对象；即在输入时是先加载整个模块，生成一个对象，然后再从这个对象上面读取方法，这种加载称为“运行时加载”。</p>
<p><code>编译时加载</code>: ES6 模块不是对象，而是通过 export 命令显式指定输出的代码，import命令会被 JavaScript 引擎静态分析，在编译时就引入指定的模块代码，而不是加载整个模块，这种加载称为“编译时加载”。</p>
<p><a href="https://www.cnblogs.com/unclekeith/archive/2017/10/17/7679503.html" target="_blank" rel="noopener">https://www.cnblogs.com/unclekeith/archive/2017/10/17/7679503.html</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="http://github.com/clexerwang">Github</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CommonJS—NodeJS"><span class="toc-number">1.</span> <span class="toc-text">CommonJS—NodeJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CMD—SeaJS"><span class="toc-number">2.</span> <span class="toc-text">CMD—SeaJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AMD与CMD"><span class="toc-number">3.</span> <span class="toc-text">AMD与CMD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6模块机制："><span class="toc-number">4.</span> <span class="toc-text">ES6模块机制：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6与CommonJS区别"><span class="toc-number">5.</span> <span class="toc-text">ES6与CommonJS区别</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/03/13/JavaScript的模块化/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&text=JavaScript的模块化"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&is_video=false&description=JavaScript的模块化"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=JavaScript的模块化&body=Check out this article: http://yoursite.com/2019/03/13/JavaScript的模块化/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&title=JavaScript的模块化"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/03/13/JavaScript的模块化/&name=JavaScript的模块化&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 ___
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="http://github.com/clexerwang">Github</a></li>
        
      </ul>
    </nav>
  </div>
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/hybrid.min.css"> <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>


    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-37473492-6', 'auto');
        ga('send', 'pageview');
    </script>



